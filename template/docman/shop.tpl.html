<!DOCTYPE html>
<html lang="da">
	<head>
		<meta charset="utf-8">
		<meta name="author" content="Frederik Yssing" />
		<meta name="generator" content="notepad++" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta property="description" content="[DESCRIPTION]" />
		<meta property="og:title" content="[TITLE]" />
		<meta property="og:description" content="[DESCRIPTION]" />
		<meta property="og:type" content="[WEBTYPE]" />
		<meta property="fb:app_id" content="[APP_ID]" />
		<meta property="og:url" content="[URL]" />
		<meta property="og:image" content="[TEMPLATE]/images/logo.png" />
		<title>[TITLE]</title>
		<!-- scripts -->
		<link href="[PATH]/contributions/jquery-ui/css/redmond/jquery-ui-1.10.4.custom.css" rel="stylesheet">
		<script src="[PATH]/contributions/jquery-ui/js/jquery-1.10.2.js"></script>
		<script src="[PATH]/contributions/jquery-ui/js/jquery-ui-1.10.4.custom.js"></script>
		<script src="[PATH]/contributions/MD5.js" type="text/javascript"></script>
		<!-- bootstrap -->
		<link href="[PATH]/contributions/bootstrap-3.1.1/dist/css/bootstrap.css" rel="stylesheet">
		<link href="[PATH]/contributions/bootstrap-3.1.1/dist/css/bootstrap-responsive.css" rel="stylesheet">
		<script src="[PATH]/contributions/bootstrap-3.1.1/dist/js/bootstrap.min.js" type="text/javascript"></script>

		<!-- Template -->
		<link rel="stylesheet/less" type="text/css" href="[TEMPLATE]/style/frontpage.less" />
		<link rel="stylesheet/less" type="text/css" href="[STYLE]" />
		
		<script src="[PATH]/contributions/less.min.js" type="text/javascript"></script>
		<script src="[PATH]/scripts/js-collection.js" type="text/javascript"></script>
	</head>
	<body>
		<script>
			// use this global variable to tell how the basket scroller should behave
			var basketScroll = 1;

			// You can also use "$(window).load(function() {"
			$(function () {
				var isLoading = false;
				var canLoad = false;
				var lazyoffset = 24;

				$("#slider1").responsiveSlides({
					auto: true,
					pager: false,
					nav: true,
					speed: 1000,
					namespace: "callbacks"
				});

				$.get('/modules/shop/basket/list_basket', function(data){
					$('#basket-container').html(data);
				});

				var basketOffset = $("#basket-container").offset();
				var basketWidth = $("#basket-container").width();

				$(window).scroll(function() {
					var currentScroll = $(window).scrollTop();
					var stickyHeight = $(".stickyheader").height();

					if(typeof basketOffset != 'undefined'){
						if (currentScroll > (basketOffset.top - (stickyHeight+10)) && basketScroll) {
							$('#basket-container').css("position","fixed");
							$('#basket-container').css("top","120px");
							$('#basket-container').css("width",basketWidth+"px");
						} else {
							$('#basket-container').css("position","relative");
							$('#basket-container').css("top","0px");
						}
					}

					var isScrolledIntoView = function(){
						var currentScroll = $(window).scrollTop();
						var scrollOffset = ($("#bottom-scroller").offset().top - $(window).height());
						if (scrollOffset < currentScroll){
							return true;
						}
						return false;
					}

					/** 
					 * load new content, if scrolled to bottom and if not
					 * already loading and ONLY if search button has been pressed
					 */
					if(isScrolledIntoView() && !isLoading && canLoad){
						lazyLoad();
					}
				});

				$( "#slider-range" ).slider({
					range: true,
					min: [MINVALUE],
					max: [MAXVALUE],
					values: [ [MINVALUE], [MAXVALUE] ],
					slide: function( event, ui ) {
						$( "#val-min" ).html( ui.values[ 0 ] );
						$( "#val-max" ).html( ui.values[ 1 ] );
					}
				});
				$( "#val-min" ).html( $( "#slider-range" ).slider( "values", 0 ) );
				$( "#val-max" ).html( $( "#slider-range" ).slider( "values", 1 ) );

				$.get('/modules/shop/list_items', function(data){
					$("#shop-body").html(data);
				});

				$( "#filter-items" ).click(function(){
					var data = {};
					data['group'] = $("#group").val();
					data['size'] = $("#size").val();
					data['length'] = $("#length").val();
					data['color'] = $("#color").val();
					data['supplier'] = $("#supplier").val();
					data['itemstatus'] = $("#itemstatus").val();
					data['pattern'] = $("#pattern").val();
					data['val-min'] = $("#val-min").html();
					data['val-max'] = $("#val-max").html();
					data['from'] = 0;
					data['to'] = 24;
					data['orderby'] = $("#orderby").val();
					lazyoffset = 24;
					$("#shop-body").html('<img style="display: block; margin: 0 auto;margin-top:250px;" src="[TEMPLATE]/images/download.gif">');

					$.post('/modules/shop/find', data, function(data){
						$("#shop-body").html(data);
						canLoad = true;
					});
				});

				//function lazyLoad(){
				var lazyLoad = function (){
					isLoading = true;

					var data = {};
					data['group'] = $("#group").val();
					data['size'] = $("#size").val();
					data['length'] = $("#length").val();
					data['color'] = $("#color").val();
					data['supplier'] = $("#supplier").val();
					data['itemstatus'] = $("#itemstatus").val();
					data['pattern'] = $("#pattern").val();
					data['val-min'] = $("#val-min").html();
					data['val-max'] = $("#val-max").html();
					data['from'] = 12;
					data['to'] = lazyoffset;
					data['orderby'] = $("#orderby").val();

					$.post('/modules/shop/find', data, function(data){
						$("#shop-body").append(data);
						isLoading = false;
						lazyoffset += 12;
					});
				}
			});

			var verifyamount = function(id){
				itemid = $("#"+id).data("id");
				$.get('/modules/shop/item/find_amount/'+itemid, function(data) {
					if(data != 'un'){
						if(parseInt(data) < parseInt($("#"+id).val())){
							$("#"+id).effect("pulsate", {}, 1000,function(){
								$("#"+id).val(parseInt(data));
								$.get('/common/query/get_text/shop_no_stock', function(data){
									alert(data);
								});
							});
						}
					}
				});
			}

			var subtractFrom = function(id = ''){
				var lID = (id) ? id : "itemamount";
				var amount = $("#"+lID).val();
				
				if (amount == '') {
					amount = 0;
				} else {
					if(amount > 0){
						amount--;
					}
				}	
				$("#"+lID).val(amount);
			}

			var addTo = function(id = ''){
				if(!id){
					return false;
				}
				var amount = $("#"+id).val();
				var max = $("#"+id).data("max");

				if (amount == '') {
					amount = 1;
				} else {
					if(max == 'un'){
						amount++;
					} else {
						if(parseInt(max) <= parseInt(amount)){
							$("#"+id).effect("pulsate", {}, 1000,function(){
								amount = parseInt(max);
								$.get('/common/query/get_text/shop_no_stock', function(data){
									alert(data);
								});
							});
						} else {
							amount++;
						}
					}
				}	
				$("#"+id).val(amount);
			}

			var addToBasket = function() { 
				var itemamount = $('#itemamount').val();
				var iteminstock = $("#itemamount").data("max");	
					
				if(parseInt(iteminstock) < parseInt(itemamount) && iteminstock != 'un'){
					$("#item-data").effect("pulsate", {}, 1000,function(){
						$.get('/common/query/get_text/shop_no_stock', function(data){
							alert(data);
						});
					});
				} else {
					var data = {};
					data['itemid'] = $("#itemamount").data("id");
					data['amount'] = itemamount;

					$.post('/modules/shop/basket/add_item/', data, function(itemdata){
						$.get('/common/query/get_text/shop_basket_added', function(data){
							alert(data);
						});
						$.get('/modules/shop/basket/list_basket/', function(data){
							$("#basket-container").html(data);
						});
					});
				}
			};
		</script>
		<div class="stickyheader">
			<div class="container menu">[MENU]</div>
		</div>
		<div class="container holder">
			<!--div class="text-header">[HEADER]</div-->
			<div class="scrolltarget"></div>
			<div class="content">[BODY]</div>
		</div>
		<div id="bottom-scroller"></div>
		<div class="footer1 hidden-xs">
			<div class="container footer1block">
				<div class="container footer1content"></div>
				<div class="container footer1text">[FOOTER]</div>
			</div>
		</div>
		<div class="footer2">
			<div class="container footer2content">[COPY]</div>
		</div>
	</body>
</html>