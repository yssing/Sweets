<!DOCTYPE html>
<html>
	<head>
		<script type="text/javascript">	
		const NUMBEROFPARTICLES = 2000;
		
		function particle(PosX,PosY,Size,Speed,Color,Slope,Step){
			this.PosX=PosX;
			this.PosY=PosY;
			this.Size=Size;
			this.Speed=Speed;
			this.Color=Color;
			this.Slope=Slope;
			this.Step=Step;
		}		
		
		function randomFromTo(from, to){
			return Math.floor(Math.random() * (to - from + 1) + from);
		}		
		
		function Setup(){
			document.getElementById('myCanvas').width = 400//window.innerWidth-20;
			document.getElementById('myCanvas').height = 400//window.innerHeight-20;	
			for(i=0;i<=NUMBEROFPARTICLES;i++){
				tempx = Math.floor(document.getElementById('myCanvas').width/2);
				PosX = -50;
				PosY = randomFromTo(document.getElementById('myCanvas').height,document.getElementById('myCanvas').height-200);
				Size = randomFromTo(1,2);					
				Speed = randomFromTo(1,5);
				tmpcolor = randomFromTo(250,255);
				Color = 'rgba('+tmpcolor+','+tmpcolor+','+tmpcolor+','+200+')';
				Slope = randomFromTo(-3,3);
				particle[i] = new particle(PosX,PosY,Size,Speed,Color,Slope,0);
			}				
		}


		//this is the function that gives us roughly 24fps
		function DelayDraw(ms){
			setTimeout("movestuff()", ms);
		}		
		
		function movestuff(){
			var ctx=document.getElementById("myCanvas").getContext("2d");
			ctx.fillStyle = 'rgb(0,0,0)';
			//Black background
			ctx.fillRect(0,0,document.getElementById('myCanvas').width,document.getElementById('myCanvas').height);	

			for(i=0;i<=NUMBEROFPARTICLES;i++){
				if(particle[i].PosY <= document.getElementById('myCanvas').height-randomFromTo(150,260)){
					tempx = Math.floor(document.getElementById('myCanvas').width/2);
					particle[i].PosX = tempx//(randomFromTo(-1,1)*100)+tempx;
					particle[i].PosY = document.getElementById('myCanvas').height;
					particle[i].Slope = randomFromTo(-3,3);
					particle[i].Speed = randomFromTo(1,5);
					particle[i].Size = randomFromTo(1,2);
					tmpcolor = randomFromTo(250,255);
					particle[i].Color = 'rgba('+tmpcolor+','+tmpcolor+','+tmpcolor+','+200+')';
					particle[i].Step=0;		
				}	
				//just because this is easy, of sorts
				if(particle[i].PosY < document.getElementById('myCanvas').height-randomFromTo(5,25)){
					particle[i].Color = 'rgba('+randomFromTo(250,255)+','+randomFromTo(250,255)+','+randomFromTo(10,10)+','+200+')';
				}
				if(particle[i].PosY < 20 || particle[i].PosY < document.getElementById('myCanvas').height-randomFromTo(15,30)){
					particle[i].Color = 'rgba('+randomFromTo(250,255)+','+randomFromTo(150,200)+','+randomFromTo(10,10)+','+200+')';
				}	
				if(particle[i].PosY < 35 || particle[i].PosY < document.getElementById('myCanvas').height-randomFromTo(30,45)){
					particle[i].Color = 'rgba('+randomFromTo(250,255)+','+randomFromTo(50,100)+','+randomFromTo(10,10)+','+200+')';
				}
				if(particle[i].PosY < 65 || particle[i].PosY < document.getElementById('myCanvas').height-randomFromTo(60,80)){
					particle[i].Color = 'rgba('+randomFromTo(250,255)+','+randomFromTo(10,30)+','+randomFromTo(10,10)+','+200+')';
				}		
				if(particle[i].PosY < 95 || particle[i].PosY < document.getElementById('myCanvas').height-randomFromTo(85,110)){
					particle[i].Color = 'rgba('+randomFromTo(150,200)+','+randomFromTo(10,20)+','+randomFromTo(10,10)+','+200+')';
				}		
				if(particle[i].PosY < 110 || particle[i].PosY < document.getElementById('myCanvas').height-randomFromTo(105,125)){
					particle[i].Color = 'rgba('+randomFromTo(100,150)+','+randomFromTo(10,20)+','+randomFromTo(10,10)+','+200+')';
				}	
				if(particle[i].PosY < 130 || particle[i].PosY < document.getElementById('myCanvas').height-randomFromTo(125,145)){
					tmpgrgb = randomFromTo(100,150)
					particle[i].Color = 'rgba('+tmpgrgb+','+tmpgrgb+','+tmpgrgb+','+200+')';
				}
				if(particle[i].PosY < 150 || particle[i].PosY < document.getElementById('myCanvas').height-randomFromTo(145,165)){
					tmpgrgb = randomFromTo(50,100)
					particle[i].Color = 'rgba('+tmpgrgb+','+tmpgrgb+','+tmpgrgb+','+200+')';
				}				
				if(particle[i].PosY < 170 || particle[i].PosY < document.getElementById('myCanvas').height-randomFromTo(165,190)){
					tmpgrgb = randomFromTo(30,60)
					particle[i].Color = 'rgba('+tmpgrgb+','+tmpgrgb+','+tmpgrgb+','+200+')';
				}
				if(particle[i].PosY < 185 || particle[i].PosY < document.getElementById('myCanvas').height-randomFromTo(180,205)){
					tmpgrgb = randomFromTo(5,30)
					particle[i].Color = 'rgba('+tmpgrgb+','+tmpgrgb+','+tmpgrgb+','+200+')';
				}
				if(particle[i].PosY < 200 || particle[i].PosY < document.getElementById('myCanvas').height-randomFromTo(190,225)){
					tmpgrgb = randomFromTo(0,15)
					particle[i].Color = 'rgba('+tmpgrgb+','+tmpgrgb+','+tmpgrgb+','+200+')';
				}				
				particle[i].PosY -= particle[i].Speed;
				particle[i].Step++;
				
				if(randomFromTo(1,2) == 1)
				{
					particle[i].PosX += randomFromTo(-2,2);
				}
				
				/*ctx.fillStyle=particle[i].Color;
				ctx.beginPath();
				ctx.arc(particle[i].PosX,particle[i].PosY,particle[i].Size,0,Math.PI*2,true);
				ctx.fill();	*/
				ctx.fillStyle=particle[i].Color;
				ctx.fillRect(particle[i].PosX,particle[i].PosY,particle[i].Size,particle[i].Size);
				
			}	
			DelayDraw(24);
		}				
		</script>	
	</head>
	
	<body onload="Setup(),movestuff()">
		<canvas id="myCanvas" width="200" height="200" style="position:absolute;top:0,left:0;border:1px solid #c3c3c3;">
			Your browser does not support the canvas element.
		</canvas>
	</body>
</html>
